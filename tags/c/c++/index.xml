<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>C/C++ on zlaazlaa's blog</title><link>https://blog.zlaaa.top/tags/c/c++/</link><description>Recent content in C/C++ on zlaazlaa's blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Wed, 04 Dec 2024 18:27:07 +0800</lastBuildDate><atom:link href="https://blog.zlaaa.top/tags/c/c++/index.xml" rel="self" type="application/rss+xml"/><item><title>VS Code C/C++ 插件 cpptools CPU 占用过高</title><link>https://blog.zlaaa.top/p/fix-vscode-cpptools-cpu-usage-too-high/</link><pubDate>Wed, 04 Dec 2024 18:27:07 +0800</pubDate><guid>https://blog.zlaaa.top/p/fix-vscode-cpptools-cpu-usage-too-high/</guid><description>&lt;p>在使用 VS Code 打开包含大量文件的 C/C++ 项目时，经常会遇到 CPU 占用过高的问题。尤其是当同时打开多个 VS Code 窗口时，CPU 占用会成倍增加，有时甚至高达 400%，几乎完全占满 4 个核心。经排查，这是由于 C/C++ 插件在分析代码，而我的项目中包含 Linux 源码、u-boot 源码、buildroot 源码等大型代码库，导致插件一直在进行代码分析，进而引发系统卡顿。&lt;/p>
&lt;h2 id="解决方法排除目录">解决方法：排除目录
&lt;/h2>&lt;p>可以通过修改 settings.json 文件，为 C/C++ 插件排除特定目录。以下是我的配置示例：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;C_Cpp.files.exclude&amp;#34;&lt;/span>&lt;span class="err">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;**/.git&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;**/workdir&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;**/wkdir&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;**/build&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;**/bin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;/PROJECT_ROOT/COMPONENT/ANONYMIZED&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>值得注意的是，配置的是&lt;code>C_Cpp.files.exclude&lt;/code>而非&lt;code>files.exclude&lt;/code>，如果配置成后者，这些目录会被 VS Code 的文件资源管理器排除，跟消失了一样。&lt;/li>
&lt;/ul>
&lt;h2 id="配置说明">配置说明
&lt;/h2>&lt;p>&lt;code>**/workdir&lt;/code> 和 &lt;code>**/wkdir&lt;/code>：我的项目中，大量外部源码存储在这两个目录中。&lt;/p>
&lt;p>&lt;code>/PROJECT_ROOT/COMPONENT/ANONYMIZED&lt;/code>：该目录是 C/C++ 插件缓存代码分析结果的存储位置，排除它可以防止插件重复递归分析自身的缓存文件而产生死循环。&lt;/p>
&lt;h2 id="参考">参考
&lt;/h2>&lt;p>有关插件缓存目录（&lt;code>/PROJECT_ROOT/COMPONENT/ANONYMIZED&lt;/code>）的更多讨论，可以参考 &lt;a class="link" href="https://github.com/microsoft/vscode-cpptools/issues/10271#issuecomment-1363489906" target="_blank" rel="noopener"
>GitHub Issue&lt;/a>。&lt;/p></description></item></channel></rss>